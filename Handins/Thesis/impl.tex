%!TEX root = ../main.tex

In this chapter, we explain implementation details of our method.
We devised our method so that it could be used entirely on a mobile device. To that end, the implementation uses different technologies. We used the Google Street View app for panoramic image capture, it's available for both iOS and Android and it's a ready-made solution to use panoramic images as a tool for our experiments. The base of the implementation is done in Unity, but with a native code library written in C++. Our library uses OpenCV for the image processing tasks. OpenCV is also available as a library for Unity, but we decided to create our own custom library because we identified limitations in the OpenCV for Unity library. It is a paid library, it doesn't have all the functionality that its C++ counterpart does, and it is slower than a native code library.\newline
All of these technologies are platform independent, even as some adjustments do have to be made in order to target either iOS or Android. For instance, to be able to use the panoramic images created with Street View, we had to create a native code plugin to read images from the file system of the device. This plugin needs separate implementations for Android and iOS. The ARToolKit library is used for the Augmented Reality tasks of tracking markers and providing the virtual world's point of reference. The device used for this particular implementation is an iPad Air tablet running iOS 11. Having said that, adjusting the application to support Android devices as well would be a simple task.\newline
The OpenCV API has all the necessary functions implemented to apply the mathematical functions proposed in the method section so this part of the implementation was a direct translation into code. We used the tools available in Unity for the sake of achieving the desired graphic quality. Reflections are implemented using Reflection Probes for example. Shadows are baked using Unity, but we created a custom shader for the "shadow catcher" plane. We also applied a full screen Film Grain effect to the composted scene. We dit it in order to make the clean virtual camera match the noisy device's camera and so homologate the look of both the real and virtual camera.